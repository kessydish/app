function initAutocomplete(){var a={lat:44.0635437,lng:12.5639284},b=new google.maps.StreetViewService;panorama=new google.maps.StreetViewPanorama(document.getElementById("pano"),{fullscreenControl:!1}),markerSatLat=$("#js-marker-satellite-lat").text(a.lat),markerSatLng=$("#js-marker-satellite-lng").text(a.lng),map=new google.maps.Map(document.getElementById("map"),{center:a,zoom:13,streetViewControl:!1}),b.getPanorama({location:a,radius:50},processSVData);var c=document.getElementById("pac-input"),d=new google.maps.places.SearchBox(c);map.addListener("bounds_changed",function(a){d.setBounds(map.getBounds())}),d.addListener("places_changed",function(a){var c=d.getPlaces();if(0!=c.length){var e=new google.maps.LatLngBounds;c.forEach(function(a){setMapOnAll(null),myMarker(a.geometry.location),void 0===a.geometry.viewport?(e.union(a.geometry.viewport),$("#js-notification").show().find(".notification-text").text("Street View data not found for this location")):(e.extend(a.geometry.location),mapsLatitudine=a.geometry.location.lat(),mapsLongitudine=a.geometry.location.lng(),$("#js-lat").text(mapsLatitudine),$("#js-long").text(mapsLongitudine),markerSatLat=$("#js-marker-satellite-lat").text(mapsLatitudine),markerSatLng=$("#js-marker-satellite-lng").text(mapsLongitudine),b.getPanorama({location:{lat:mapsLatitudine,lng:mapsLongitudine},radius:50},processSVData))}),map.fitBounds(e)}})}function myMarker(a){var b={url:"https://filippoquacquarelli.it/kessydish/images/satellite.png",size:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,40)},c=new google.maps.Marker({map:map,icon:b,position:a,draggable:!0});markers.push(c),google.maps.event.addListener(c,"dragend",function(){markerLat=c.getPosition().lat(),markerLng=c.getPosition().lng(),(new google.maps.StreetViewService).getPanorama({location:{lat:markerLat,lng:markerLng},radius:50},processSVData),markerSatLat=$("#js-marker-satellite-lat").text(markerLat),markerSatLng=$("#js-marker-satellite-lng").text(markerLng)})}function setMapOnAll(a){for(var b=0;b<markers.length;b++)markers[b].setMap(a)}function processSVData(a,b){if(b===google.maps.StreetViewStatus.OK){var c=new google.maps.Marker({position:a.location.latLng,map:map,title:a.location.description});panorama.setPano(a.location.pano),panoramaHeading=45,panoramaPitch=0,panorama.setPov({heading:panoramaHeading,pitch:panoramaPitch}),panorama.setVisible(!0),c.addListener("click",function(){var b=a.location.pano;panorama.setPano(b),panorama.setPov({heading:panoramaHeading,pitch:panoramaPitch}),panorama.setVisible(!0)}),$("#js-notification").hide()}else $("#js-notification").show().find(".notification-text").text("Street View data not found for this location")}function reprocessSVData(a,b){panorama.setPov({heading:a,pitch:b}),$("#azimuth_google").text(a),$("#elevation_google").text(b)}function azimuth(a,b,c){return longdiffr=(c-a)/57.29578,esazimuth=180+57.29578*Math.atan(Math.tan(longdiffr)/Math.sin(b/57.29578)),b<0&&(esazimuth-=180),esazimuth<0&&(esazimuth+=360),esazimuth}function elevation(a,b,c){return longdiffr=(c-a)/57.29578,eslatr=b/57.29578,r1=1+35786/6378.16,v1=r1*Math.cos(eslatr)*Math.cos(longdiffr)-1,v2=r1*Math.sqrt(1-Math.cos(eslatr)*Math.cos(eslatr)*Math.cos(longdiffr)*Math.cos(longdiffr)),eselevation=57.29578*Math.atan(v1/v2),eselevation}function tilt(a,b,c){return longdiffr=(a-c)/57.29578,eslatr=b/57.29578,poltilt=-57.29578*Math.atan(Math.sin(longdiffr)/Math.tan(eslatr)),poltilt}function computeform(){eselevation=elevation(longitudineSatelliteValue,mapsLatitudine,mapsLongitudine),esazimuth=azimuth(longitudineSatelliteValue,mapsLatitudine,mapsLongitudine),gradiIncrement=parseInt($("#gradi-elevation").val()),$("#elevation").text(eselevation),$("#azimuth").text(esazimuth),$("#js-view-details-elevation").text(eselevation),$("#js-view-details-azimuth").text(esazimuth),reprocessSVData(esazimuth,eselevation+gradiIncrement)}function satelliteLong(){$("#satellite").change(function(){var a=$("#satellite option:selected").text();longitudineSatelliteValue=$("#satellite option:selected").val(),$("#satellite option:selected").each(function(){longitudineSatelliteValue}),$("#namesat").text(a),$("#longsat").text(longitudineSatelliteValue)}).trigger("change")}function debug(){$("body").on("keydown",function(a){68==a.which&&a.ctrlKey&&a.altKey&&($("#debug").find(".debug__body").addClass("is-visible"),$("#debug").find(".fade").addClass("in"))}),$("#js-debug__close").click(function(){$("#debug").find(".debug__body").removeClass("is-visible"),$("#debug").find(".fade").removeClass("in")})}function buttonVisibleBox(a,b,c){$(a).click(function(){0==c?$(b).addClass("is-visible"):1==c&&$(b).toggleClass("is-visible")})}function notification(){$("#js-notification").find(".btn-close").click(function(){$("#js-notification").hide()})}function gmapResize(){$(window).width()<768?($("#map").css({width:"0px",height:"0px"}),$("#js-gmap-resize").click(function(){var a=280==$("#map").width()?"0px":"280px",b=160==$("#map").height()?"0px":"160px";$("#map").css({width:a,height:b})})):$(window).width()>767&&$(window).width()<1025&&($("#map").css({width:"0px",height:"0px"}),$("#js-gmap-resize").click(function(){var a=480==$("#map").width()?"0px":"480px",b=480==$("#map").height()?"0px":"480px";$("#map").css({width:a,height:b})}))}function reset(){$("#js-input-reset").css("display","none"),$("input[type=text]").val("")}var map,panorama,markers=[];$("#js-calcAziElev").click(function(){"undefined"==typeof mapsLatitudine||null===mapsLatitudine?$("#js-notification").show().find(".notification-text").text("Select a destination in the search bar"):computeform(),$("#js-mirino").addClass("in"),setTimeout(function(){$("#js-mirino").removeClass("in")},1e4)}),$(document).ready(function(){satelliteLong(),debug(),buttonVisibleBox("#js-view-details","#js-container-view-details",toggle=!0),buttonVisibleBox("#js-view-info__button","#js-view-info",toggle=!0),notification(),gmapResize(),$("#pac-input").keyup(function(){$(this).val().length>0&&(inputReset=$("#js-input-reset"),inputReset.css("display","block"),inputReset.click(function(){reset()}))})}),$(window).load(function(){});
